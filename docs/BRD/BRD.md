# ビジネス要件定義書（BRD） — IP Connect

## 1. 目的
- MVPで「クリエイターがIPを掲載 → 企業がリクエスト → クリエイターが承認 → 記録」をデジタルに実現し、`02_Problem` の課題と `03_Solution` の解決策に整合させる。
- 主要カテゴリー（声・イラスト・振付）で明確な利用条件と価格レンジを提示し、権利の曖昧さを減らす。

## 2. 目標（MVP）
- クリエイターがIPを公開し、メタデータ・利用条件・価格レンジを設定できる。
- 企業がIPを発見・詳細閲覧し、構造化された問い合わせを送信できる。
- クリエイターが問い合わせを承認/却下し、履歴が残る。
- システムが権利/利用情報（terms・ステータス・タイムスタンプ）を保持し、法務リスクを低減する。

## 3. スコープ
- インスコープ
  - 役割: `creator` / `company`（Supabaseのロールに準拠）。
  - カテゴリ/タイプ: 声・イラスト・振付（`IP_CATEGORIES` と `AssetType`）。
  - 公開カタログ（タイプフィルタ付き）とIP詳細ページ（プレビュー、価格、terms、メタデータ）。
  - クリエイター向けIP作成/編集（タイトル・説明・カテゴリ・asset_type・file_url・price_min/max・terms preset/notes・タイプ別メタデータ）。
  - 問い合わせ受付（purpose/region/budget/period/message）とステータス管理（pending/approved/rejected）。
  - 簡易アナリティクス（ユーザ/資産/問い合わせ/支払ステータスの件数）。
  - 権限チェックとリダイレクト（クリエイター以外の編集拒否、未ログイン→ログイン誘導）。
- アウトオブスコープ（MVP）
  - 決済（Stripe等）、自動契約生成、ブロックチェーン台帳、エンタープライズAPI、チームアカウント。
  - 高度検索/推薦、通知システムの拡張、DRM/透かし、マルチ言語UI（英語ベースのみ）。

## 4. ユーザー / ペルソナ
- クリエイター（声優/VTuber、イラストレーター、振付師）: 価格と条件を明確化し、安全に承認・収益化したい。
- 企業（代理店、スタジオ、ブランド、ゲーム/広告/VTuberチーム）: 権利が明確なIPを素早く調達したい。
- 内部/管理: 最低限のヘルス確認と不正監視。

## 5. ユーザージャーニーと要件
- カタログ閲覧（企業）
  - `type=voice|choreography|all` でフィルタ。カードにカテゴリ/タイプ/タイトル/リンクを表示。
- IP詳細（企業）
  - asset_typeに応じたプレビュー（voice=audio、その他=image/video）、説明、terms preset/notes、価格レンジ、タイプ別メタデータを表示。
  - 「Request License」で問い合わせフォームへ遷移。
- IP作成/編集（クリエイター）
  - 必須項目入力、Supabase Storageへのアップロード（バケット `ip-assets`）、タイプ別メタデータ入力。
  - creator_id を持つ本人のみ編集可。既存ファイルを保持可能。
- ダッシュボード（クリエイター）
  - 自身のIP一覧（タイプ/カテゴリ/作成日）と View/Edit 導線、新規作成ショートカット。
- 問い合わせ管理（クリエイター）
  - 構造化された問い合わせを受信し、ステータスを pending/approved/rejected に更新。タイムスタンプで監査可能。
- アナリティクス（内部）
  - ユーザ/資産/問い合わせ件数とステータス・支払いステータス（paid_simulated含む）の内訳を表示。

## 6. データ要件
- エンティティ
  - `users`: id, email, role, profile
  - `ip_assets`: id, creator_id, title, description, category, asset_type, file_url, metadata(Voice/Choreo), terms(preset/notes), price_min/max, timestamps
  - `inquiries`: id, ip_id, creator_id, company_id, purpose, region, period/timeline, budget, message, status, payment_status, timestamps
  - `logs` またはタイムスタンプによる監査: event_type, user, target, timestamp
- ストレージ: Supabase Storage バケット `ip-assets` にメディアを保存。
- フィルタ: asset_type クエリに対応し、カテゴリ互換を維持。

## 7. 成功指標（MVP）
- 機能: クリエイターがIP公開/編集できる、企業が問い合わせを完了できる、ステータスが保存・表示される、タイプ別メタデータが表示される。
- 定量: クリエイター100人、問い合わせ30件以上、承認率50%以上、インタビューでの肯定的フィードバック。

## 8. 前提 / 制約
- 技術: Next.js 14 + Supabase（Auth/DB/Storage）+ Tailwind/shadcn。
- 役割: Supabase Authのロールに依存。サーバーコンポーネント主体でデータ取得。
- メディア: 音声/画像/動画のみ。DRM/透かしなし。
- 法務: 契約テンプレ自動生成なし。termsはプレーンテキストJSON。

## 9. リスクと緩和
- メタデータ/terms不足による権利曖昧さ → 必須項目とプリセット活用で最低限の明確化。
- ダウンロード後の不正利用 → 承認ログで抑止、DRMは後続。
- 国際化不足 → 英語ベースで先行、後続で多言語対応。
- 支払い/ステータスの混乱 → 支払いは「simulated」と明示、UIにも反映。

## 10. 受入基準
- クリエイターが必須項目を満たしてIPを作成/編集でき、データが取得・再表示できる。
- カタログがタイプフィルタで動作し、IP詳細でプレビュー/価格/terms/メタが適切に表示される。
- 問い合わせが作成され、クリエイターがステータスを更新でき、履歴が残る。
- ボイス/振付メタデータが詳細ページで正しく表示される。
- アナリティクスがエラーなく件数と内訳を表示する。
- 権限/リダイレクトがBRD要件どおりに機能する。
